<script lang="ts">
  import PrintExecutiveHeader from './PrintExecutiveHeader.svelte';
  import PrintCategoryBreakdown from './PrintCategoryBreakdown.svelte';
  import PrintTopImprovements from './PrintTopImprovements.svelte';
  import type { CategoryMetric } from './PrintCategoryBreakdown.svelte';
  import type { ImprovementGroup } from './PrintTopImprovements.svelte';

  export let processedResults: {
    id: string | null;
    job_title: string | null;
    job_url: string | null;
  } & Record<string, unknown>;
  export let overallScore: number;
  export let overallStatus: { label: string; badge?: string };
  export let hasOptimizedView: boolean;
  export let categoryMetrics: CategoryMetric[];
  export let improvementGroups: ImprovementGroup[];
  export let generalRecommendations: string[];
  export let formattedPrintedDate: string;
</script>

<!-- Authenticated User Print Layout - Full Details -->
<div class="print:w-full print:break-inside-avoid">
  <div class="grid grid-cols-2">
  <!-- Print Header -->
  <div class="print:mb-4 col-span-2">
    <PrintExecutiveHeader
      jobTitle={processedResults.job_title}
      reportId={processedResults.id}
      jobUrl={processedResults.job_url}
      {overallScore}
      statusLabel={overallStatus.label}
    />
  </div>
  <!-- <div> <PrintCategoryBreakdown metrics={categoryMetrics} /></div> -->
</div>
  <!-- Print Content -->
  <div class="print:mb-4">
    <!-- Optimized Notice (if applicable) -->
    {#if hasOptimizedView}
      <div class="print:mb-3">
        <!-- <OptimizedScoreNotice
          reportId={results.id}
          originalScore={overallScore}
          {optimizedScore}
          {getScoreBadgeClasses}
          heading="You're viewing the original scorecard and analysis."
          description="This keeps the category breakdown aligned with the initial score before optimization."
          improvementLabel="Change"
          linkHref={`/results?report=${results.id}&view=optimized`}
          linkLabel="View optimized report"
        /> -->
      </div>
    {/if}
    
    <!-- Main Content Grid -->
    <div class="print:grid print:grid-cols-2 print:gap-6 print:mb-8 ">
      <!-- Left Column: Category Breakdown -->
      <div class="print:space-y-4 col-span-2">
        <PrintCategoryBreakdown metrics={categoryMetrics} />
      </div>
      
      <!-- Right Column: Top Improvements -->
      <div class="print:space-y-4  print:w-full col-span-2">
        <PrintTopImprovements groups={improvementGroups} generalRecommendations={generalRecommendations} />
      </div>
    </div>
  </div>

  <!-- Print Footer -->
  <div class="print:flex print:justify-between print:items-center print:pt-3 print:border-t print:border-gray-200 print:text-xs print:text-gray-500 print:mt-6">
    <div>
      <p class="print:m-0">Generated by JobPostScore â€¢ {formattedPrintedDate}</p>
    </div>
    <div>
      <p class="print:m-0">Report ID: {processedResults.id}</p>
    </div>
  </div>
</div>
