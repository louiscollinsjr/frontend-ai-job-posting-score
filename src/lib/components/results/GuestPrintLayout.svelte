<script>
  export let processedResults;
  export let overallScore;
  export let formattedPrintedDate;
  export let onShowSaveDialog;
  export let onDownloadReport;

  // Get score color based on overall score
  function getScoreColor(/** @type {number} */ score) {
    if (score >= 85) return '#10b981'; // green-500
    if (score >= 60) return '#f59e0b'; // amber-500
    if (score >= 40) return '#ef4444'; // orange-500
    return '#ef4444'; // red-500
  }

  // Get score band text
  // function getScoreBand(score) {
  //   if (score >= 85) return 'Excellent';
  //   if (score >= 60) return 'Good';
  //   if (score >= 40) return 'Risky';
  //   return 'Poor';
  // }
</script>

<!-- Guest User Print Layout - Compact Single Page -->
<div
  class="print-layout relative mx-auto my-0 box-border w-[8.5in] min-h-[11in] border border-gray-200 bg-white p-[0.75in] text-[9pt] leading-[1.3] text-[#374151] shadow-[0_4px_20px_rgba(0,0,0,0.15)] print:my-0 print:w-full print:min-h-0 print:max-w-none print:border-0 print:bg-white print:p-5 print:text-[#374151] print:shadow-none"
>
  <!-- Compact Header -->
  <div class="mb-6 mt-12 border-b border-gray-200 pb-4 text-center print:mb-6 print:pb-4">
    <!-- Logo + Title -->
    <div class="mb-2 flex items-center justify-center gap-2">
      <img src="/jobpostscore_logo.svg" alt="JobPostScore" class="h-9 w-auto print:h-6" />
      <h1 class="text-3xl font-semibold text-gray-900">Analysis</h1>
    </div>
    <p class="mt-1 mb-4 text-[10px] italic text-gray-500">Here's how your job posting performed across 7 key metrics</p>
    
    <!-- Score Section -->
    <div class="my-10 flex items-center justify-center gap-4">
      <div
        class="flex h-40 w-40 flex-col items-center justify-center rounded-full border-[15px] bg-white"
        style={`border-color: ${getScoreColor(overallScore)}`}
      >
        <div class="text-6xl font-bold leading-none text-gray-900">{overallScore}</div>
        <div class="mt-1 text-[8px] text-gray-500">(0-100)</div>
      </div>
    </div>
    
    <!-- Job Info -->
    <div class="mb-4 text-center">
      {#if processedResults.job_title}
        <p class="mb-1 text-sm font-semibold text-gray-700">{processedResults.job_title}</p>
      {/if}
      <p class="text-[9px] leading-[1.4] text-gray-500">
        <strong>JobPostScore ID:</strong> {processedResults.id}
        {#if processedResults.job_url}
          <br /><strong>Source:</strong> <span class="break-all text-blue-600 underline">{processedResults.job_url}</span>
        {/if}
      </p>
    </div>
  </div>

  <!-- Compact CTA Section -->
  <div class="mx-auto my-20 max-w-[400px] rounded-lg border border-gray-200 bg-gray-50 p-5 text-center print:my-20">
    <div class="mb-2 inline-block rounded-full bg-gray-900 px-2 py-1 text-[8px] font-semibold tracking-[0.025em] text-white">
      ðŸ”“ UNLOCK YOUR COMPLETE SCORECARD
    </div>
    <h2 class="my-2 text-5xl font-semibold text-gray-900">Turn insights<br />into action</h2>
    <p class="mb-4 text-sm leading-relaxed text-gray-600">
      Get guided optimization suggestions at JobPostScore.com
    </p>

    <div class="mx-auto mb-3 flex w-full max-w-xl flex-col gap-2">
      <button
        type="button"
        class=" hidden mx-auto w-full max-w-[15rem] rounded-full border border-transparent bg-gray-900 px-5 py-2 text-xs font-semibold text-white"
        on:click={onShowSaveDialog}
      >
        Save & Improve This Report
      </button>
      <button
        type="button"
        class="hidden mx-auto w-full max-w-[15rem] rounded-full border border-gray-300 bg-white px-5 py-2 text-[8px] font-semibold text-gray-700"
        on:click={onDownloadReport}
      >
        Print This Scorecard
      </button>
    </div>

    <p class="text-[8px] text-gray-400">Free account â€¢ No credit card required â€¢ Export ready</p>
  </div>

  <!-- Print Footer -->
  <div class="mt-6 flex items-center justify-between border-t border-gray-200 pt-3 text-[8px] text-gray-500">
    <p class="m-0">Generated by JobPostScore â€¢ {formattedPrintedDate}</p>
    <p class="m-0">Report ID: {processedResults.id}</p>
  </div>
</div>
